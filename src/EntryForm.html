<!DOCTYPE html>
<html>
  <body>
    <div>
      <label>大人人数:</label>
      <input type="number" id="adultCount">
    </div>
    <div>
      <label>子供人数:</label>
      <input type="number" id="childCount">
    </div>
    <div id="optionsContainer">
        <!-- ここに動的にチェックボックスが追加 -->
    </div>
    <button onclick="submitData()">送信</button>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            google.script.run.withSuccessHandler(populateOptions).getOptions();
        });
        function populateOptions(optionList) {
            const containerElem = document.getElementById('optionsContainer');

            optionList.forEach(function(option) {
                const labelElem = document.createElement('label');
                labelElem.innerText = option.label;

                const inputElem = document.createElement('input');
                inputElem.type = 'checkbox';
                inputElem.value = option.value;
                inputElem.className = 'optionCheckbox'; // クラス名を追加して後で選択を取得しやすくします

                containerElem.appendChild(inputElem);
                containerElem.appendChild(labelElem);
                containerElem.appendChild(document.createElement('br')); // 改行を追加
            });
        }
        function submitData() {
        var adultCount = document.getElementById("adultCount").value;
        var childCount = document.getElementById("childCount").value;
        var selectedOptions = Array.from(document.querySelectorAll('.optionCheckbox:checked')).map(checkbox => checkbox.value);

        google.script.run.appendFormData(adultCount, childCount, selectedOptions);
        google.script.host.close();
        }
    </script>
  </body>
</html>